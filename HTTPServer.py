import zlib

from flask import Flask, request, Response
from flask_restful import Resource, Api

app = Flask(__name__)
api = Api(app)

class SimpleHTTPRequestHandler(Resource):

    def get(self):
        original = '{\"startup\":1,\"id\":\"ianvm01.gmo.lab\",\"hostid\":\"005056a6c09e\",\"start_time\":\"2020-Mar-10 17:11:53\",\"up_time\":\"71:37:13\",\"inputs\":0,\"max_inputs\":20000,\"outputs\":28,\"max_outputs\":20000,\"remote_in_kbps\":0,\"local_in_kbps\":0,\"remote_out_kbps\":0,\"local_out_kbps\":0,\"http_out_kbps\":0,\"kbytes_sent\":0,\"kbytes_received\":0,\"rtmp_on\":1,\"transcoded_kbytes\":0,\"interfaces\":{\"inputs\":[{\"port\":2088,\"nic\":\"\"}],\"outputs\":[{\"port\":2077,\"nic\":\"\"}],\"mmt\":[]},\"licensing\":{\"status\":1,\"version\":\"2.2\",\"licenses\":[{\"name\":\"Product\",\"id\":\"product\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"permanent\",\"error\":\"\",\"info\":\"broadcaster\"},{\"name\":\"remote\",\"id\":\"remote\",\"used\":\"\",\"limit\":\"\",\"exp\":\"\",\"error\":\"\",\"info\":\"demo-2610-e968-e9ba\"},{\"name\":\"Activation Key\",\"id\":\"key\",\"used\":\"\",\"limit\":\"\",\"exp\":\"\",\"error\":\"\",\"info\":\"https://license.zixi.com/info/activations/demo-2610-e968-e9ba\"},{\"name\":\"ASI Inputs\",\"id\":\"asi_in\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"ASI Outputs\",\"id\":\"asi_out\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Input bitrate [Mbps]\",\"id\":\"input_bitrate\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Output bitrate [Mbps]\",\"id\":\"output_bitrate\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Protected bitrate [Mbps]\",\"id\":\"protected_bitrate\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Protected Streams\",\"id\":\"protected_streams\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"RTMP Pull Inputs\",\"id\":\"rtmp_in_pull\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"RTMP Push Inputs\",\"id\":\"rtmp_in_push\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"RTMP Pull Outputs\",\"id\":\"rtmp_out_pull\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"RTMP Push Outputs\",\"id\":\"rtmp_out_push\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Transcoders\",\"id\":\"transcoders\",\"used\":\"0\",\"limit\":\"0\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"UDP Inputs\",\"id\":\"udp_in\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"UDP Outputs\",\"id\":\"udp_out\",\"used\":\"28\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Zixi Pull Inputs\",\"id\":\"zixi_in_pull\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Zixi Push Inputs\",\"id\":\"zixi_in_push\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Zixi Pull Outputs\",\"id\":\"zixi_out_pull\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Zixi Push Outputs\",\"id\":\"zixi_out_push\",\"used\":\"0\",\"limit\":\"Unlimited\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Bonding\",\"id\":\"bonding\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Cluster\",\"id\":\"cluster\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Crossbrand\",\"id\":\"crossbrand\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"\",\"error\":\"No license for product\",\"info\":\"Disabled\"},{\"name\":\"File transfer\",\"id\":\"file_transfer\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Matrix\",\"id\":\"matrix\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"OTT\",\"id\":\"ott\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Pro-MPEG\",\"id\":\"pro_mpeg\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"Pro output\",\"id\":\"pro_output\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"RIST in\",\"id\":\"rist_in\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"\",\"error\":\"No license for product\",\"info\":\"Disabled\"},{\"name\":\"RIST out\",\"id\":\"rist_out\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"\",\"error\":\"No license for product\",\"info\":\"Disabled\"},{\"name\":\"Time Shift\",\"id\":\"shifting\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"TR101\",\"id\":\"tr101\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"16-mar-2020\",\"error\":\"\",\"info\":\"\"},{\"name\":\"x264 Transcoding\",\"id\":\"x264_transcoding\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"\",\"error\":\"No license for product\",\"info\":\"Disabled\"},{\"name\":\"Expiration Date\",\"id\":\"exp_date\",\"used\":\"\",\"limit\":\"Enabled\",\"exp\":\"permanent\",\"error\":\"\",\"info\":\"16-mar-2020\"}]},\"machine\":{\"machine_model\":\"VMware Virtual Platform\",\"machine_manufacturer\":\"VMware, Inc.\",\"installed_cpus\":8,\"number_of_cores\":1,\"logical_cpus\":8,\"cpu_brand\":\"Intel(R) Xeon(R) CPU E5-2699 v3 @ 2.30GHz\",\"vm\":1,\"avx_support\":1,\"ram_insatlled\":67281637376,\"intel_gpu\":\"\"},\"os\":{\"caption\":\"CentOS Linux release 8.0.1905 (Core) \",\"build\":\"4.18.0-80.7.1.el8_0.x86_64\",\"arch\":\"x86_64\",\"nvidia_driver_version\":\"Failed to query driver version\",\"nvidia_driver_up_to_date\":0,\"cuda_version\":\"Failed to query cuda version\",\"cuda_up_to_date\":0}}'
        response = Response()
        response.direct_passthrough = False
        response.data = zlib.compress(original.encode())
        response.headers['Content-Encoding'] = 'deflate'
        response.headers['Content-Length'] = len(response.data)
        response.headers['Content-Type'] = 'application/json'
        
        return response

api.add_resource(SimpleHTTPRequestHandler, '/request')

if __name__ == '__main__':
    print("serving at port", 8000)
    app.run(port='8000', host='0.0.0.0')
